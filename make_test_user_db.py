import numpy as np
import redis
import json
r = redis.Redis(host='localhost', port=6379, db=0)
r1 = redis.Redis(host='localhost', port=6379, db=1)
test =[118062586,118062597,118062633,118062830,118062873,118062883,118062902,118062955,118063064,118063126,118063173,118063211,118063321,118063324,118063342,118063369,118063382,118063397,118063408,118063429,118063448,118063452,118063478,118063488,118063490,118063509,118063513,118063515,118063521,118063533,118063536,118063542,118063546,118063566,118063584,118063608,117638539,117638807,117639038,117639044,117639048,117639051,117639068,117639071,117639074,117639090,117639280]
test_ga = ['117995083', '117867403', '117996813', '117828556', '118058018', '117766432', '117845883', '117836563', '117776449', '117925227', '117846976', '118100453', '117848011', '117815088', '118100341', '117874258', '117853519', '118147936', '118081626', '117924726', '117779785', '118136183', '117897837', '117747817', '117752456', '117905513', '117851462', '117906542', '117871865', '117784810', '117982566', '117890586', '117845041', '117811088', '117829369', '118021422', '117821187', '117808078', '118024104', '117912900', '117930591', '117962224', '117819718', '117800029', '117815540', '118143903', '118138324', '117894057', '117939814', '117775665', '117764939', '118048995', '117852407', '117791161', '117808088', '118051427', '118000658', '118100501', '118111962', '118053485', '118138576', '117981492', '117986050', '117996057', '117999506', '117873114', '117818706', '118040009', '118021295', '117905543', '117798009', '117977012', '118084414', '118037504', '117819349', '118103786', '117993682', '118086577', '117799500', '117819353', '117962258', '118135957', '117891169', '117808228', '117989752', '117994192', '117854321', '117839518', '117808139', '117912390', '118030905', '117920947', '117774769', '117905690', '117985844', '118014919', '117887043', '118053338', '117867971', '117787409', '117979229', '118155301']
print(len(test))
print(len(test_ga))
#
# a = []
# for i in r.keys('*'):
#     a.append(i.decode('utf-8'))
# print(a)
# for gid in test:
#     temp = json.loads(r.get(gid))
#     print(temp)


## r1 (유저 db 테스트로 만들어봄.
# 유저db 는   ga : vec  으로 돼있음.
# ga 는 test_ga 를, vec은 test의 vec을 쓸꺼임.
r1.flushdb()
print(r1.keys('*'))
for ga in test_ga:
    vec = r.get(ga)
    print(np.frombuffer(vec, dtype='float32').shape)
    r1.set(ga,vec)
print("=======================")

# print(np.frombuffer(r2.get('117808078'), dtype='float32'))